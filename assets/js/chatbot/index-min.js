const base_url=$("#base_url").val(),user_email=$("#user_email").val(),user_img=$("#user_img").val(),chatbot_img=$("#chatbot_img").val();function sendMessage(t,e){$.post("getMessageOrStep",t,(function(t){let{response:s,suggestion:n,trigger:i}=JSON.parse(t);splitSuggestions=n?n.split("|"):[],setTimeout((()=>printMsgChatbot(s,splitSuggestions)),500),e.prop("disabled",!1).prop("readonly",!1).val(""),i&&setTimeout((()=>sendMessage(`step=${i}`,e)),1e3)}))}function printMsgUser(t){$(".direct-chat-messages").last().append(`\n        <div class="direct-chat-msg right">\n            <div class="direct-chat-info clearfix">\n                <span class="direct-chat-name pull-right">${user_email}</span>\n            </div>\n            <img class="direct-chat-img" src="${user_img}">\n            <div class="direct-chat-text">\n                ${t}\n            </div>\n        </div>\n    `),moveScroll()}function printMsgChatbot(t,e){$(".direct-chat-messages").last().append(`\n        <div class="direct-chat-msg">\n            <div class="direct-chat-info clearfix">\n                <span class="direct-chat-name pull-left">Bot</span>\n            </div>\n            <img class="direct-chat-img" src="${chatbot_img}">\n            <div class="direct-chat-text">\n                ${t}\n            </div>\n            ${printSuggestions(e)}\n        </div>\n    `),moveScroll()}function moveScroll(){let t=$(".direct-chat-messages");t.animate({scrollTop:t.prop("scrollHeight")})}function printSuggestions(t){let e=t.length>0?"<small>Sugerencias:</small>":"";return t.forEach((t=>{e+=`<button type="button" class="btn btn-warning btn-xs btnSuggestion">${t}</button> `})),e}$("#form_chatbot").submit((function(t){t.preventDefault();let e=$(this),s=e.find("input, button");if(!s[0].value)return;let n=e.serialize();printMsgUser(s[0].value),sendMessage(n,s)})),$(document).ready((function(){$(document).on("click",".btnSuggestion",(function(){let t=$(this).text(),e=$("#form_chatbot").find("input, button");printMsgUser(t),sendMessage(`message=${t}`,e)}))}));